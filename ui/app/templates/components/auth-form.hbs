<div class="auth-form">
  {{#if showLoading}}
    <div class="vault-loader">
      {{partial 'svg/vault-loading'}}
    </div>
  {{/if}}
  {{#if hasMethodsWithPath}}
  <nav class="tabs is-marginless">
    <ul>
      {{#each methodsToShow as |method|}}
        {{#with (or method.path method.type) as |methodKey|}}
            <li class="{{if (and selectedAuthIsPath (eq (or selectedAuthBackend.path selectedAuthBackend.type) methodKey)) 'is-active' ''}}" data-test-auth-method>
              {{#link-to 'vault.cluster.auth' cluster.name (query-params with=methodKey) data-test-auth-method-link=method.type}}
                {{or method.id (capitalize method.type)}}
              {{/link-to}}
            </li>
        {{/with}}
      {{/each}}
      {{#if hasMethodsWithPath}}
        <li class="{{if (not selectedAuthIsPath) 'is-active' ''}}" data-test-auth-method>
          {{#link-to 'vault.cluster.auth' cluster.name (query-params with='token') data-test-auth-method-link="other"}}
            Other
          {{/link-to}}
        </li>
      {{/if}}
    </ul>
  </nav>
  {{/if}}
  <form
    id="auth-form"
    onsubmit={{action (if isOIDC "startOIDCAuth" "doSubmit")}}
  >
    <div class="box is-marginless is-shadowless">
      <MessageError
        @errorMessage={{if (and cluster.standby hasCSPError) cspErrorText error}}
        data-test-auth-error
      />
      {{#if (or (not hasMethodsWithPath) (not selectedAuthIsPath))}}
        <div class="field">
          <label for="selectedMethod" class="is-label">
            Method
          </label>
          <div class="control is-expanded" >
            <div class="select is-fullwidth">
              <select
                name="selectedMethod"
                id="selectedMethod"
                onchange={{action (mut selectedAuth) value="target.value"}}
                data-test-method-select
              >
                {{#each (supported-auth-backends) as |method|}}
                  <option selected={{eq selectedAuthBackend.type method.type}} value={{method.type}}>
                    {{capitalize method.type}}
                  </option>
                {{/each}}
              </select>
            </div>
          </div>
        </div>
      {{/if}}
      {{#if (eq this.selectedAuthBackend.type "jwt")}}
      <AuthJwt
        @selectedAuthPath={{or this.selectedAuthBackend.id this.customPath}}
        @onRoleChange={{action (mut this.role)}}
        @isOIDC={{this.isOIDC}}
      />
      {{else}}
        {{partial providerPartialName}}
      {{/if}}
      {{#if (and (not selectedAuthIsPath) (not-eq selectedAuthBackend.type "token"))}}
        <div class="box has-slim-padding is-shadowless">
          {{toggle-button toggleTarget=this toggleAttr="useCustomPath"}}
          <div class="field">
            {{#if useCustomPath}}
              <label for="custom-path" class="is-label">
                Mount path
              </label>
              <div class="control">
                <input
                   type="text"
                   name="custom-path"
                   id="custom-path"
                   class="input"
                   value={{customPath}}
                   oninput={{action (mut customPath) value="target.value"}}
                />
              </div>
                <p class="help has-text-grey-dark">
                If this backend was mounted using a non-default path, enter it here.
                </p>
            {{/if}}
          </div>
        </div>
      {{/if}}
    </div>
    <div class="box is-marginless is-shadowless">
      <button data-test-auth-submit=true type="submit" disabled={{authenticate.isRunning}} class="button is-primary {{if authenticate.isRunning 'is-loading'}}" id="auth-submit">
        {{#if isOIDC}}
        Sign In via {{or this.role.providerName 'OIDC Provider'}}
        {{else}}
        Sign In
        {{/if}}
      </button>
    </div>
  </form>
</div>
